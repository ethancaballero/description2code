#include <iostream>
#include <cstdio>
#include <string>
#include <cstring>
#include <map>
#define ll long long
using namespace std;

ll dp[17][100];
map<char,ll> m;
bool pp;
ll t,e,f;

bool mod(ll base,string n){
	ll l = n.length();
	ll w = 0;
	for(ll i=0;i<l;i++){
		char b = n.at(i);
		ll g = m[b];
		w *= base;
		w += g;
		w %= l;

	}
	if(w==0)
		return true;
	return false;

}

ll recurse(ll base, string current,char ch[]){

	string next;
	ll u = 1;
	bool f = false;
	for(ll i=0;i<base;i++){

		next = current + ch[i];

		if(mod(base,next) && next.length()<42){
		f = true;
		//cout << "next"<<next<<endl;
			u += recurse(base,next,ch);
		}
	}

	dp[base][current.length()] += 1;
	return u;
}

void ini(){

dp[2][1] = 1;
dp[2][2] = 1;
dp[3][1] = 2;
dp[3][2] = 3;
dp[3][3] = 3;
dp[3][4] = 3;
dp[3][5] = 2;
dp[3][6] = 2;
dp[4][1] = 3;
dp[4][2] = 6;
dp[4][3] = 8;
dp[4][4] = 8;
dp[4][5] = 7;
dp[4][6] = 4;
dp[4][7] = 1;
dp[5][1] = 4;
dp[5][2] = 10;
dp[5][3] = 17;
dp[5][4] = 21;
dp[5][5] = 21;
dp[5][6] = 21;
dp[5][7] = 13;
dp[5][8] = 10;
dp[5][9] = 6;
dp[5][10] = 4;
dp[6][1] = 5;
dp[6][2] = 15;
dp[6][3] = 30;
dp[6][4] = 45;
dp[6][5] = 54;
dp[6][6] = 54;
dp[6][7] = 49;
dp[6][8] = 46;
dp[6][9] = 21;
dp[6][10] = 3;
dp[6][11] = 1;
dp[7][1] = 6;
dp[7][2] = 21;
dp[7][3] = 49;
dp[7][4] = 87;
dp[7][5] = 121;
dp[7][6] = 145;
dp[7][7] = 145;
dp[7][8] = 145;
dp[7][9] = 121;
dp[7][10] = 92;
dp[7][11] = 56;
dp[7][12] = 33;
dp[7][13] = 20;
dp[7][14] = 14;
dp[7][15] = 7;
dp[7][16] = 3;
dp[7][17] = 1;
dp[7][18] = 1;
dp[8][1] = 7;
dp[8][2] = 28;
dp[8][3] = 74;
dp[8][4] = 148;
dp[8][5] = 238;
dp[8][6] = 324;
dp[8][7] = 367;
dp[8][8] = 367;
dp[8][9] = 320;
dp[8][10] = 258;
dp[8][11] = 188;
dp[8][12] = 122;
dp[8][13] = 69;
dp[8][14] = 37;
dp[8][15] = 12;
dp[8][16] = 6;
dp[8][17] = 3;
dp[9][1] = 8;
dp[9][2] = 36;
dp[9][3] = 108;
dp[9][4] = 252;
dp[9][5] = 454;
dp[9][6] = 706;
dp[9][7] = 898;
dp[9][8] = 1039;
dp[9][9] = 1039;
dp[9][10] = 1039;
dp[9][11] = 869;
dp[9][12] = 674;
dp[9][13] = 473;
dp[9][14] = 309;
dp[9][15] = 216;
dp[9][16] = 126;
dp[9][17] = 66;
dp[9][18] = 34;
dp[9][19] = 18;
dp[9][20] = 8;
dp[9][21] = 5;
dp[9][22] = 3;
dp[10][1] = 9;
dp[10][2] = 45;
dp[10][3] = 150;
dp[10][4] = 375;
dp[10][5] = 750;
dp[10][6] = 1200;
dp[10][7] = 1713;
dp[10][8] = 2227;
dp[10][9] = 2492;
dp[10][10] = 2492;
dp[10][11] = 2225;
dp[10][12] = 2041;
dp[10][13] = 1575;
dp[10][14] = 1132;
dp[10][15] = 770;
dp[10][16] = 571;
dp[10][17] = 335;
dp[10][18] = 180;
dp[10][19] = 90;
dp[10][20] = 44;
dp[10][21] = 18;
dp[10][22] = 12;
dp[10][23] = 6;
dp[10][24] = 3;
dp[10][25] = 1;
dp[11][1] = 10;
dp[11][2] = 55;
dp[11][3] = 202;
dp[11][4] = 560;
dp[11][5] = 1232;
dp[11][6] = 2278;
dp[11][7] = 3574;
dp[11][8] = 4959;
dp[11][9] = 6074;
dp[11][10] = 6709;
dp[11][11] = 6709;
dp[11][12] = 6709;
dp[11][13] = 5703;
dp[11][14] = 4493;
dp[11][15] = 3294;
dp[11][16] = 2217;
dp[11][17] = 1468;
dp[11][18] = 872;
dp[11][19] = 514;
dp[11][20] = 282;
dp[11][21] = 143;
dp[11][22] = 65;
dp[11][23] = 28;
dp[11][24] = 14;
dp[11][25] = 7;
dp[11][26] = 2;
dp[12][1] = 11;
dp[12][2] = 66;
dp[12][3] = 264;
dp[12][4] = 792;
dp[12][5] = 1900;
dp[12][6] = 3800;
dp[12][7] = 6514;
dp[12][8] = 9772;
dp[12][9] = 13030;
dp[12][10] = 15471;
dp[12][11] = 16799;
dp[12][12] = 16799;
dp[12][13] = 15652;
dp[12][14] = 13418;
dp[12][15] = 10748;
dp[12][16] = 8079;
dp[12][17] = 5688;
dp[12][18] = 3774;
dp[12][19] = 2381;
dp[12][20] = 1435;
dp[12][21] = 817;
dp[12][22] = 445;
dp[12][23] = 226;
dp[12][24] = 108;
dp[12][25] = 45;
dp[12][26] = 20;
dp[12][27] = 3;
dp[12][28] = 1;
dp[13][1] = 12;
dp[13][2] = 78;
dp[13][3] = 338;
dp[13][4] = 1105;
dp[13][5] = 2874;
dp[13][6] = 6278;
dp[13][7] = 11660;
dp[13][8] = 19068;
dp[13][9] = 27607;
dp[13][10] = 36136;
dp[13][11] = 42702;
dp[13][12] = 46610;
dp[13][13] = 46610;
dp[13][14] = 46610;
dp[13][15] = 41294;
dp[13][16] = 33796;
dp[13][17] = 25982;
dp[13][18] = 18892;
dp[13][19] = 13103;
dp[13][20] = 8577;
dp[13][21] = 5356;
dp[13][22] = 3162;
dp[13][23] = 1743;
dp[13][24] = 944;
dp[13][25] = 470;
dp[13][26] = 250;
dp[13][27] = 126;
dp[13][28] = 63;
dp[13][29] = 25;
dp[13][30] = 10;
dp[13][31] = 4;
dp[13][32] = 2;
dp[13][33] = 2;
dp[13][34] = 2;
dp[13][35] = 1;
dp[14][1] = 13;
dp[14][2] = 91;
dp[14][3] = 424;
dp[14][4] = 1484;
dp[14][5] = 4154;
dp[14][6] = 9707;
dp[14][7] = 19414;
dp[14][8] = 29121;
dp[14][9] = 42063;
dp[14][10] = 59159;
dp[14][11] = 75615;
dp[14][12] = 88747;
dp[14][13] = 95597;
dp[14][14] = 95597;
dp[14][15] = 89036;
dp[14][16] = 80204;
dp[14][17] = 65867;
dp[14][18] = 51176;
dp[14][19] = 37661;
dp[14][20] = 26428;
dp[14][21] = 17759;
dp[14][22] = 11353;
dp[14][23] = 6821;
dp[14][24] = 4096;
dp[14][25] = 2220;
dp[14][26] = 1165;
dp[14][27] = 605;
dp[14][28] = 310;
dp[14][29] = 139;
dp[14][30] = 69;
dp[14][31] = 27;
dp[14][32] = 10;
dp[14][33] = 6;
dp[14][34] = 2;
dp[14][35] = 1;
dp[14][36] = 1;
dp[14][37] = 1;
dp[14][38] = 1;
dp[14][39] = 1;
dp[15][1] = 14;
dp[15][2] = 105;
dp[15][3] = 525;
dp[15][4] = 1995;
dp[15][5] = 5985;
dp[15][6] = 15960;
dp[15][7] = 34199;
dp[15][8] = 64409;
dp[15][9] = 107154;
dp[15][10] = 171563;
dp[15][11] = 233954;
dp[15][12] = 296371;
dp[15][13] = 342124;
dp[15][14] = 368134;
dp[15][15] = 368134;
dp[15][16] = 368134;
dp[15][17] = 324876;
dp[15][18] = 281553;
dp[15][19] = 222037;
dp[15][20] = 171005;
dp[15][21] = 122130;
dp[15][22] = 84431;
dp[15][23] = 54937;
dp[15][24] = 34827;
dp[15][25] = 20907;
dp[15][26] = 12333;
dp[15][27] = 7023;
dp[15][28] = 3880;
dp[15][29] = 2057;
dp[15][30] = 1167;
dp[15][31] = 564;
dp[15][32] = 260;
dp[15][33] = 129;
dp[15][34] = 62;
dp[15][35] = 20;
dp[15][36] = 7;
dp[15][37] = 1;
dp[15][38] = 1;
dp[16][1] = 15;
dp[16][2] = 120;
dp[16][3] = 640;
dp[16][4] = 2560;
dp[16][5] = 8192;
dp[16][6] = 21888;
dp[16][7] = 50030;
dp[16][8] = 100060;
dp[16][9] = 178236;
dp[16][10] = 285074;
dp[16][11] = 414662;
dp[16][12] = 554018;
dp[16][13] = 681778;
dp[16][14] = 779164;
dp[16][15] = 831886;
dp[16][16] = 831886;
dp[16][17] = 782347;
dp[16][18] = 701717;
dp[16][19] = 591178;
dp[16][20] = 473607;
dp[16][21] = 361604;
dp[16][22] = 263114;
dp[16][23] = 183069;
dp[16][24] = 121870;
dp[16][25] = 78013;
dp[16][26] = 48065;
dp[16][27] = 28497;
dp[16][28] = 16204;
dp[16][29] = 8852;
dp[16][30] = 4742;
dp[16][31] = 2457;
dp[16][32] = 1216;
dp[16][33] = 565;
dp[16][34] = 259;
dp[16][35] = 124;
dp[16][36] = 46;
dp[16][37] = 21;
dp[16][38] = 10;
dp[16][39] = 3;
}

int main() {
	// your code goes here

	// char ch[16]={'0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'};

	// for(ll i=0;i<16;i++)
	// 	m[ch[i]] = i;

	// memset(dp,0,sizeof dp);

	// for(ll i=2;i<=16;i++){
	// 	for(ll j=1;j<i;j++){

	// 		string s = "";
	// 		s += ch[j];
	// 		ll k = recurse(i,s,ch);
	// 	}
	// }

	// for(ll i=2;i<=16;i++){
	// 	for(ll j=1;j<100;j++){
	// 		if(dp[i][j]==0)
	// 			break;
	// 		printf("dp[%lld,%lld] = %lld
",i,j,dp[i][j]);
	// 	}
	// }

	ini();

	scanf("%lld",&t);

	while(t--){
		scanf("%lld %lld",&e,&f);
		if(f>95)
			f = 95;
		printf("%lld
",dp[e][f]);
	}

	return 0;
}