#include<cstdio>
#include<iostream>
#include<cstdlib>
#include<cstring>
#include<sstream>
#include<bitset>
#include<vector>
#include<algorithm>

using namespace std;
typedef vector<int> vi;
#define pb push_back
#define REP(i,a,b)    for(int(i)=int(a);i<=int(b);i++)
#define REPMIN(i,a,b)     for(int(i)=int(a);i>=int(b);i--)
#define REPC(i,a,b,c)    for(int(i)=int(a);i<=int(b);i+=int(c))

vi primes;
bitset<505> bs;
void sieve(){
    bs.reset();
    bs.flip();
    bs.set(0,false);
    bs.set(1,false);
    REP(i,2,504){
        if(bs.test(i)){
            REPC(j,i*i,504,i)
                bs.set(j,false);
            primes.pb(i);
        }
//        primes.pb(i);
    }
}

int ip[502][502],leftc[502][502],rightc[502][502],top[502][502],down[502][502];
int main(){
    int T,R,C,totalcount,val,tmpval;
    string line,input;
    bool flag;
    sieve();
    scanf("%d",&T);
    while(T--){
        scanf("%d",&R);
        scanf("%d",&C);
        getline(cin,line);
        REP(i,0,R-1){
//            getline(cin,line);
//            stringstream ss(line);
            REP(j,0,C-1){
//                ss >> input;
//                cout<<input<<" ";
//                ip[i][j]=atoi(input.c_str());
                ip[i][j]=getchar();
//               cout<<ip[i][j]<<" ";
                leftc[i][j]=0;
                rightc[i][j]=0;
                top[i][j]=0;
                down[i][j]=0;
//                printf("%d ",ip[i][j]);
            }
//            printf("
");
            getline(cin,line);
        }
        REP(i,0,C-1){
            if(ip[0][i]=='#')
                top[0][i]=-1;
            if(ip[R-1][i]=='#')
                down[R-1][i]=-1;
        }
        REP(i,0,R-1){
            if(ip[i][0]=='#')
                leftc[i][0]=-1;
            if(ip[i][C-1]=='#')
                rightc[i][C-1]=-1;
        }
        REP(i,0,R-1){
            REP(j,1,C-1){
                if(ip[i][j]=='^')
                    leftc[i][j]=leftc[i][j-1]+1;                     
                else
                    leftc[i][j]=-1;
                    
//                printf("%d ",leftc[i][j]);
            }
//            printf("
");
        }
        REP(i,0,C-1){
            REP(j,1,R-1){
                if(ip[j][i]=='^')
                    top[j][i]=top[j-1][i]+1;
                else
                    top[j][i]=-1;
//                printf("%d ",top[i][j]);
            }
//            printf("
");
        }
        REP(i,0,R-1){
            REPMIN(j,C-2,0){
                if(ip[i][j]=='^')
                    rightc[i][j]=rightc[i][j+1]+1;
                else
                    rightc[i][j]=-1;
//                printf("%d ",rightc[i][j]);
            }
//            printf("
");
        }
        REP(i,0,C-1){
            REPMIN(j,R-2,0){
                if(ip[j][i]=='^')
                    down[j][i]=down[j+1][i]+1;
                else
                    down[j][i]=-1;
//                printf("%d ",down[i][j]);
            }
//            printf("
");
        }
        totalcount = 0;
//        cout<<"size of primes is "<<primes.size()<<endl;
        REP(i,0,R-1){
            REP(j,0,C-1){
                flag = false;
                if(ip[i][j]=='^'){
                    val = min(min(leftc[i][j],rightc[i][j]),min(top[i][j],down[i][j]));
//                    cout<<val<<" ";
                    REP(k,0,primes.size()-1){
                        if(primes[k]>val){
                            tmpval = k;
                            break;
                        }
                        else{
                            flag = true;
                            tmpval = k+1;
                        }
                    }
                }
                if(flag){
//                    cout<<"tmpval is now "<<tmpval<<endl;
                    totalcount+=tmpval;
                }
            }
        }
        printf("%d
",totalcount);
    }
    return 0;
}
