alls = (
'0000000001111',
'0000000010111',
'0000000011011',
'0000000011101',
'0000000011110',
'0000000100111',
'0000000101011',
'0000000101101',
'0000000101110',
'0000000110011',
'0000000110101',
'0000000110110',
'0000000111001',
'0000000111010',
'0000000111100',
'0000001000111',
'0000001001011',
'0000001001101',
'0000001001110',
'0000001010011',
'0000001010101',
'0000001010110',
'0000001011001',
'0000001011010',
'0000001011100',
'0000001100011',
'0000001100101',
'0000001100110',
'0000001101001',
'0000001101010',
'0000001101100',
'0000001110001',
'0000001110010',
'0000001110100',
'0000001111000',
'0000010000111',
'0000010001011',
'0000010001101',
'0000010001110',
'0000010010011',
'0000010010101',
'0000010010110',
'0000010011001',
'0000010011010',
'0000010011100',
'0000010100011',
'0000010100101',
'0000010100110',
'0000010101001',
'0000010101010',
'0000010101100',
'0000010110001',
'0000010110010',
'0000010110100',
'0000010111000',
'0000011000011',
'0000011000101',
'0000011000110',
'0000011001001',
'0000011001010',
'0000011001100',
'0000011010001',
'0000011010010',
'0000011010100',
'0000011011000',
'0000011100001',
'0000011100010',
'0000011100100',
'0000011101000',
'0000011110000',
'0000100000111',
'0000100001011',
'0000100001101',
'0000100001110',
'0000100010011',
'0000100010101',
'0000100010110',
'0000100011001',
'0000100011010',
'0000100011100',
'0000100100011',
'0000100100101',
'0000100100110',
'0000100101001',
'0000100101010',
'0000100101100',
'0000100110001',
'0000100110010',
'0000100110100',
'0000100111000',
'0000101000011',
'0000101000101',
'0000101000110',
'0000101001001',
'0000101001010',
'0000101001100',
'0000101010001',
'0000101010010',
'0000101010100',
'0000101011000',
'0000101100001',
'0000101100010',
'0000101100100',
'0000101101000',
'0000101110000',
'0000110000011',
'0000110000101',
'0000110000110',
'0000110001001',
'0000110001010',
'0000110001100',
'0000110010001',
'0000110010010',
'0000110010100',
'0000110011000',
'0000110100001',
'0000110100010',
'0000110100100',
'0000110101000',
'0000110110000',
'0000111000001',
'0000111000010',
'0000111000100',
'0000111001000',
'0000111010000',
'0000111100000',
'0001000000111',
'0001000001011',
'0001000001101',
'0001000001110',
'0001000010011',
'0001000010101',
'0001000010110',
'0001000011001',
'0001000011010',
'0001000011100',
'0001000100011',
'0001000100101',
'0001000100110',
'0001000101001',
'0001000101010',
'0001000101100',
'0001000110001',
'0001000110010',
'0001000110100',
'0001000111000',
'0001001000011',
'0001001000101',
'0001001000110',
'0001001001001',
'0001001001010',
'0001001001100',
'0001001010001',
'0001001010010',
'0001001010100',
'0001001011000',
'0001001100001',
'0001001100010',
'0001001100100',
'0001001101000',
'0001001110000',
'0001010000011',
'0001010000101',
'0001010000110',
'0001010001001',
'0001010001010',
'0001010001100',
'0001010010001',
'0001010010010',
'0001010010100',
'0001010011000',
'0001010100001',
'0001010100010',
'0001010100100',
'0001010101000',
'0001010110000',
'0001011000001',
'0001011000010',
'0001011000100',
'0001011001000',
'0001011010000',
'0001011100000',
'0001100000011',
'0001100000101',
'0001100000110',
'0001100001001',
'0001100001010',
'0001100001100',
'0001100010001',
'0001100010010',
'0001100010100',
'0001100011000',
'0001100100001',
'0001100100010',
'0001100100100',
'0001100101000',
'0001100110000',
'0001101000001',
'0001101000010',
'0001101000100',
'0001101001000',
'0001101010000',
'0001101100000',
'0001110000001',
'0001110000010',
'0001110000100',
'0001110001000',
'0001110010000',
'0001110100000',
'0001111000000',
'0010000000111',
'0010000001011',
'0010000001101',
'0010000001110',
'0010000010011',
'0010000010101',
'0010000010110',
'0010000011001',
'0010000011010',
'0010000011100',
'0010000100011',
'0010000100101',
'0010000100110',
'0010000101001',
'0010000101010',
'0010000101100',
'0010000110001',
'0010000110010',
'0010000110100',
'0010000111000',
'0010001000011',
'0010001000101',
'0010001000110',
'0010001001001',
'0010001001010',
'0010001001100',
'0010001010001',
'0010001010010',
'0010001010100',
'0010001011000',
'0010001100001',
'0010001100010',
'0010001100100',
'0010001101000',
'0010001110000',
'0010010000011',
'0010010000101',
'0010010000110',
'0010010001001',
'0010010001010',
'0010010001100',
'0010010010001',
'0010010010010',
'0010010010100',
'0010010011000',
'0010010100001',
'0010010100010',
'0010010100100',
'0010010101000',
'0010010110000',
'0010011000001',
'0010011000010',
'0010011000100',
'0010011001000',
'0010011010000',
'0010011100000',
'0010100000011',
'0010100000101',
'0010100000110',
'0010100001001',
'0010100001010',
'0010100001100',
'0010100010001',
'0010100010010',
'0010100010100',
'0010100011000',
'0010100100001',
'0010100100010',
'0010100100100',
'0010100101000',
'0010100110000',
'0010101000001',
'0010101000010',
'0010101000100',
'0010101001000',
'0010101010000',
'0010101100000',
'0010110000001',
'0010110000010',
'0010110000100',
'0010110001000',
'0010110010000',
'0010110100000',
'0010111000000',
'0011000000011',
'0011000000101',
'0011000000110',
'0011000001001',
'0011000001010',
'0011000001100',
'0011000010001',
'0011000010010',
'0011000010100',
'0011000011000',
'0011000100001',
'0011000100010',
'0011000100100',
'0011000101000',
'0011000110000',
'0011001000001',
'0011001000010',
'0011001000100',
'0011001001000',
'0011001010000',
'0011001100000',
'0011010000001',
'0011010000010',
'0011010000100',
'0011010001000',
'0011010010000',
'0011010100000',
'0011011000000',
'0011100000001',
'0011100000010',
'0011100000100',
'0011100001000',
'0011100010000',
'0011100100000',
'0011101000000',
'0011110000000',
'0100000000111',
'0100000001011',
'0100000001101',
'0100000001110',
'0100000010011',
'0100000010101',
'0100000010110',
'0100000011001',
'0100000011010',
'0100000011100',
'0100000100011',
'0100000100101',
'0100000100110',
'0100000101001',
'0100000101010',
'0100000101100',
'0100000110001',
'0100000110010',
'0100000110100',
'0100000111000',
'0100001000011',
'0100001000101',
'0100001000110',
'0100001001001',
'0100001001010',
'0100001001100',
'0100001010001',
'0100001010010',
'0100001010100',
'0100001011000',
'0100001100001',
'0100001100010',
'0100001100100',
'0100001101000',
'0100001110000',
'0100010000011',
'0100010000101',
'0100010000110',
'0100010001001',
'0100010001010',
'0100010001100',
'0100010010001',
'0100010010010',
'0100010010100',
'0100010011000',
'0100010100001',
'0100010100010',
'0100010100100',
'0100010101000',
'0100010110000',
'0100011000001',
'0100011000010',
'0100011000100',
'0100011001000',
'0100011010000',
'0100011100000',
'0100100000011',
'0100100000101',
'0100100000110',
'0100100001001',
'0100100001010',
'0100100001100',
'0100100010001',
'0100100010010',
'0100100010100',
'0100100011000',
'0100100100001',
'0100100100010',
'0100100100100',
'0100100101000',
'0100100110000',
'0100101000001',
'0100101000010',
'0100101000100',
'0100101001000',
'0100101010000',
'0100101100000',
'0100110000001',
'0100110000010',
'0100110000100',
'0100110001000',
'0100110010000',
'0100110100000',
'0100111000000',
'0101000000011',
'0101000000101',
'0101000000110',
'0101000001001',
'0101000001010',
'0101000001100',
'0101000010001',
'0101000010010',
'0101000010100',
'0101000011000',
'0101000100001',
'0101000100010',
'0101000100100',
'0101000101000',
'0101000110000',
'0101001000001',
'0101001000010',
'0101001000100',
'0101001001000',
'0101001010000',
'0101001100000',
'0101010000001',
'0101010000010',
'0101010000100',
'0101010001000',
'0101010010000',
'0101010100000',
'0101011000000',
'0101100000001',
'0101100000010',
'0101100000100',
'0101100001000',
'0101100010000',
'0101100100000',
'0101101000000',
'0101110000000',
'0110000000011',
'0110000000101',
'0110000000110',
'0110000001001',
'0110000001010',
'0110000001100',
'0110000010001',
'0110000010010',
'0110000010100',
'0110000011000',
'0110000100001',
'0110000100010',
'0110000100100',
'0110000101000',
'0110000110000',
'0110001000001',
'0110001000010',
'0110001000100',
'0110001001000',
'0110001010000',
'0110001100000',
'0110010000001',
'0110010000010',
'0110010000100',
'0110010001000',
'0110010010000',
'0110010100000',
'0110011000000',
'0110100000001',
'0110100000010',
'0110100000100',
'0110100001000',
'0110100010000',
'0110100100000',
'0110101000000',
'0110110000000',
'0111000000001',
'0111000000010',
'0111000000100',
'0111000001000',
'0111000010000',
'0111000100000',
'0111001000000',
'0111010000000',
'0111100000000',
'1000000000111',
'1000000001011',
'1000000001101',
'1000000001110',
'1000000010011',
'1000000010101',
'1000000010110',
'1000000011001',
'1000000011010',
'1000000011100',
'1000000100011',
'1000000100101',
'1000000100110',
'1000000101001',
'1000000101010',
'1000000101100',
'1000000110001',
'1000000110010',
'1000000110100',
'1000000111000',
'1000001000011',
'1000001000101',
'1000001000110',
'1000001001001',
'1000001001010',
'1000001001100',
'1000001010001',
'1000001010010',
'1000001010100',
'1000001011000',
'1000001100001',
'1000001100010',
'1000001100100',
'1000001101000',
'1000001110000',
'1000010000011',
'1000010000101',
'1000010000110',
'1000010001001',
'1000010001010',
'1000010001100',
'1000010010001',
'1000010010010',
'1000010010100',
'1000010011000',
'1000010100001',
'1000010100010',
'1000010100100',
'1000010101000',
'1000010110000',
'1000011000001',
'1000011000010',
'1000011000100',
'1000011001000',
'1000011010000',
'1000011100000',
'1000100000011',
'1000100000101',
'1000100000110',
'1000100001001',
'1000100001010',
'1000100001100',
'1000100010001',
'1000100010010',
'1000100010100',
'1000100011000',
'1000100100001',
'1000100100010',
'1000100100100',
'1000100101000',
'1000100110000',
'1000101000001',
'1000101000010',
'1000101000100',
'1000101001000',
'1000101010000',
'1000101100000',
'1000110000001',
'1000110000010',
'1000110000100',
'1000110001000',
'1000110010000',
'1000110100000',
'1000111000000',
'1001000000011',
'1001000000101',
'1001000000110',
'1001000001001',
'1001000001010',
'1001000001100',
'1001000010001',
'1001000010010',
'1001000010100',
'1001000011000',
'1001000100001',
'1001000100010',
'1001000100100',
'1001000101000',
'1001000110000',
'1001001000001',
'1001001000010',
'1001001000100',
'1001001001000',
'1001001010000',
'1001001100000',
'1001010000001',
'1001010000010',
'1001010000100',
'1001010001000',
'1001010010000',
'1001010100000',
'1001011000000',
'1001100000001',
'1001100000010',
'1001100000100',
'1001100001000',
'1001100010000',
'1001100100000',
'1001101000000',
'1001110000000',
'1010000000011',
'1010000000101',
'1010000000110',
'1010000001001',
'1010000001010',
'1010000001100',
'1010000010001',
'1010000010010',
'1010000010100',
'1010000011000',
'1010000100001',
'1010000100010',
'1010000100100',
'1010000101000',
'1010000110000',
'1010001000001',
'1010001000010',
'1010001000100',
'1010001001000',
'1010001010000',
'1010001100000',
'1010010000001',
'1010010000010',
'1010010000100',
'1010010001000',
'1010010010000',
'1010010100000',
'1010011000000',
'1010100000001',
'1010100000010',
'1010100000100',
'1010100001000',
'1010100010000',
'1010100100000',
'1010101000000',
'1010110000000',
'1011000000001',
'1011000000010',
'1011000000100',
'1011000001000',
'1011000010000',
'1011000100000',
'1011001000000',
'1011010000000',
'1011100000000',
'1100000000011',
'1100000000101',
'1100000000110',
'1100000001001',
'1100000001010',
'1100000001100',
'1100000010001',
'1100000010010',
'1100000010100',
'1100000011000',
'1100000100001',
'1100000100010',
'1100000100100',
'1100000101000',
'1100000110000',
'1100001000001',
'1100001000010',
'1100001000100',
'1100001001000',
'1100001010000',
'1100001100000',
'1100010000001',
'1100010000010',
'1100010000100',
'1100010001000',
'1100010010000',
'1100010100000',
'1100011000000',
'1100100000001',
'1100100000010',
'1100100000100',
'1100100001000',
'1100100010000',
'1100100100000',
'1100101000000',
'1100110000000',
'1101000000001',
'1101000000010',
'1101000000100',
'1101000001000',
'1101000010000',
'1101000100000',
'1101001000000',
'1101010000000',
'1101100000000',
'1110000000001',
'1110000000010',
'1110000000100',
'1110000001000',
'1110000010000',
'1110000100000',
'1110001000000',
'1110010000000',
'1110100000000',
'1111000000000',)

q = []
visited = {}
backTrack = {}
goalState = [0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0]

rotations = {
    0 : {
        'R' : [0, 2, 5, 8, 6, 3],
        'L' : [0, 3, 6, 8, 5, 2],
    },
    1 : {
        'R' : [1, 3, 6, 9, 7, 4],
        'L' : [1, 4, 7, 9, 6, 3],
    },
    2 : {
        'R' : [6, 8, 10, 12, 11, 9],
        'L' : [6, 9, 11, 12, 10, 8],
    },
}

def getHashKey(state):
    h = 0
    for i in range(13):
        h = h * 2 + int(state[i])
    return h

def saveSolution(key, sols):
    target = key
    sols[target] = []
    cnt = 0
    l = []
    while key != 600:
        cnt += 1
        key, no, direction, state = backTrack[key]
        direction = 1 if direction == 'L' else 0
        l.append((no, direction))

    sols[target].append(cnt)
    for no, direction in l:
        sols[target].append((no, direction))

def getSolution(key, sols):
    s = sols[key]
    print s[0]
    for i in xrange(1, len(s)):
        x, y = s[i]
        print '%d %d' % (x, y)

def diffSolution(key, sols1, sols2):
    s1 = sols1[key]
    s2 = sols2[key]
    print s1[0]
    for i in xrange(1, len(s1)):
        a, b = s1[i]
        c, d = s2[i]
        #if a != c or b != d:
        #    raise
        print '%d %d' % (a, b)
	
def transform(key, sols):
    startKey = key
    if visited.has_key(startKey):
        saveSolution(startKey, sols)
        return

    if len(q) == 0:
        q.insert(0, goalState)

    while len(q) > 0:
        state = q.pop()
        sKey = getHashKey(state)
        for rstate, no, direction in rotate(state):
            rKey = getHashKey(rstate)
            if rKey == startKey:
                visited[rKey] = True
                backTrack[rKey] = (sKey, no, direction, state)
                saveSolution(rKey, sols)
                return
            else:
                if not visited.has_key(rKey):
                    visited[rKey] = True
                    backTrack[rKey] = (sKey, no, direction, state)
                    q.insert(0, rstate)

def rotate(state):
    for no in range(3):
        for direction in ['L', 'R']:
            result = state[:]
            rot = rotations[no][direction]
            prev = 0
            tmp = result[rot[prev]]
            for cur in range(1, 6):
                result[rot[prev]] = result[rot[cur]]
                prev = cur
            result[rot[prev]] = tmp
            yield result, no, direction


sols1 = {}
for state in alls:
    key = getHashKey(list(state))
    transform(key, sols1)

q = []
visited = {}
backTrack = {}

import sys
sols2 = {}
noTestCases = int(sys.stdin.readline().rstrip())
while noTestCases > 0:
    noTestCases -= 1
    key  = getHashKey(sys.stdin.readline().rstrip())
    transform(key, sols2)
    diffSolution(key, sols1, sols2)
    #getSolution(key, sols1)
#noTestCases = int(raw_input())
#while noTestCases > 0:
#    noTestCases -= 1
#    key  = getHashKey([int(n) for n in list(raw_input())[:13]])
#    getSolution(key)
